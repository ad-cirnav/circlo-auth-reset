<script type="module">
  // 1) Load the SDK robustly
  import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

  // 2) CONFIG â€” replace with your exact values
  const SUPABASE_URL = "https://llmhxqkzoiacbfhmrnvv.supabase.co;"
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxsbWh4cWt6b2lhY2JmaG1ybnZ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ2NDMwMTMsImV4cCI6MjA3MDIxOTAxM30.2r0JMKT9-o0ZNrhIHBuxeC0n4h-zBAtBZijjVB1RzIw";

  // 3) Setup
  const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
  const form = document.getElementById("form");
  const msg = document.getElementById("msg");
  const RESET_URL = location.origin + location.pathname.replace("request-reset.html", "reset-password.html");

  function show(text){ msg.textContent = text; console.log(text); }

  // Prove the script is running
  show("Ready");

  // 4) Submit handler with strong error reporting
  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    try {
      const email = document.getElementById("email").value.trim();
      if (!email) return show("Please enter an email.");
      show("Sending...");
      const { error } = await supabase.auth.resetPasswordForEmail(email, { redirectTo: RESET_URL });
      if (error) throw error;
      show("Check your inbox for the reset link.");
    } catch (err) {
      show("Error: " + (err?.message || String(err)));
      console.error(err);
    }
  });
</script>
